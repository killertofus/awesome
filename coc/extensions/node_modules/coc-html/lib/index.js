var pe=Object.create;var N=Object.defineProperty;var ge=Object.getOwnPropertyDescriptor;var me=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,ve=Object.prototype.hasOwnProperty;var te=l=>N(l,"__esModule",{value:!0});var ye=(l,p)=>{for(var b in p)N(l,b,{get:p[b],enumerable:!0})},ne=(l,p,b,w)=>{if(p&&typeof p=="object"||typeof p=="function")for(let h of me(p))!ve.call(l,h)&&(b||h!=="default")&&N(l,h,{get:()=>p[h],enumerable:!(w=ge(p,h))||w.enumerable});return l},U=(l,p)=>ne(te(N(l!=null?pe(de(l)):{},"default",!p&&l&&l.__esModule?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l),be=(l=>(p,b)=>l&&l.get(p)||(b=ne(te({}),p,1),l&&l.set(p,b),b))(typeof WeakMap!="undefined"?new WeakMap:0);var Ce={};ye(Ce,{activate:()=>he});var D=U(require("coc.nvim"));var _=U(require("coc.nvim"));function re(l,p,b){let w,h=!1,f,d={autoQuote:!1,autoClose:!1};_.workspace.document.then(i=>{w=i.bufnr,v(i.bufnr)});function v(i){var o,c;h=!1;let n=_.workspace.getDocument(i);if(!n||!n.attached||!p[n.textDocument.languageId])return;let a=_.workspace.getConfiguration("html",n.uri);d.autoQuote=(o=a.get("autoCreateQuotes"))!=null?o:!1,d.autoClose=(c=a.get("autoClosingTags"))!=null?c:!1,h=d.autoQuote||d.autoClose}_.events.on("BufEnter",async i=>{w=i,f&&clearTimeout(f);let n=_.workspace.getDocument(w);n||(n=await _.workspace.document),v(n?n.bufnr:-1)},null,b),_.events.on("TextInsert",(i,n,a)=>{if(!h)return;let o=_.workspace.getDocument(i);if(!o||!o.attached||!p[o.textDocument.languageId])return;f&&clearTimeout(f);let c={line:n.lnum-1,character:n.pre.length};d.autoQuote&&a==="="?t("autoQuote",o,c,a):d.autoClose&&(a===">"||a==="/")&&t("autoClose",o,c,a)},null,b);function t(i,n,a,o){let c=n.changedtick;n.patchChange(!0),f=setTimeout(()=>{l(i,n.textDocument,a).then(g=>{if(g&&d[i]&&w==n.bufnr&&n.changedtick==c){let m={character:a.character,line:a.line};o==="/"&&n.getline(a.line)[a.character]==">"&&(m.character=a.character+1),_.workspace.nvim.call("coc#_cancel",[],!0),_.snippetManager.insertSnippet(g,!0,{start:a,end:m})}}),f=void 0},100)}}var T=U(require("coc.nvim")),ie=U(require("fs"));var oe;(()=>{"use strict";var l={470:h=>{function f(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function d(t,i){for(var n,a="",o=0,c=-1,g=0,m=0;m<=t.length;++m){if(m<t.length)n=t.charCodeAt(m);else{if(n===47)break;n=47}if(n===47){if(!(c===m-1||g===1))if(c!==m-1&&g===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var P=a.lastIndexOf("/");if(P!==a.length-1){P===-1?(a="",o=0):o=(a=a.slice(0,P)).length-1-a.lastIndexOf("/"),c=m,g=0;continue}}else if(a.length===2||a.length===1){a="",o=0,c=m,g=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+t.slice(c+1,m):a=t.slice(c+1,m),o=m-c-1;c=m,g=0}else n===46&&g!==-1?++g:g=-1}return a}var v={resolve:function(){for(var t,i="",n=!1,a=arguments.length-1;a>=-1&&!n;a--){var o;a>=0?o=arguments[a]:(t===void 0&&(t=process.cwd()),o=t),f(o),o.length!==0&&(i=o+"/"+i,n=o.charCodeAt(0)===47)}return i=d(i,!n),n?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(t){if(f(t),t.length===0)return".";var i=t.charCodeAt(0)===47,n=t.charCodeAt(t.length-1)===47;return(t=d(t,!i)).length!==0||i||(t="."),t.length>0&&n&&(t+="/"),i?"/"+t:t},isAbsolute:function(t){return f(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,i=0;i<arguments.length;++i){var n=arguments[i];f(n),n.length>0&&(t===void 0?t=n:t+="/"+n)}return t===void 0?".":v.normalize(t)},relative:function(t,i){if(f(t),f(i),t===i||(t=v.resolve(t))===(i=v.resolve(i)))return"";for(var n=1;n<t.length&&t.charCodeAt(n)===47;++n);for(var a=t.length,o=a-n,c=1;c<i.length&&i.charCodeAt(c)===47;++c);for(var g=i.length-c,m=o<g?o:g,P=-1,y=0;y<=m;++y){if(y===m){if(g>m){if(i.charCodeAt(c+y)===47)return i.slice(c+y+1);if(y===0)return i.slice(c+y)}else o>m&&(t.charCodeAt(n+y)===47?P=y:y===0&&(P=0));break}var O=t.charCodeAt(n+y);if(O!==i.charCodeAt(c+y))break;O===47&&(P=y)}var I="";for(y=n+P+1;y<=a;++y)y!==a&&t.charCodeAt(y)!==47||(I.length===0?I+="..":I+="/..");return I.length>0?I+i.slice(c+P):(c+=P,i.charCodeAt(c)===47&&++c,i.slice(c))},_makeLong:function(t){return t},dirname:function(t){if(f(t),t.length===0)return".";for(var i=t.charCodeAt(0),n=i===47,a=-1,o=!0,c=t.length-1;c>=1;--c)if((i=t.charCodeAt(c))===47){if(!o){a=c;break}}else o=!1;return a===-1?n?"/":".":n&&a===1?"//":t.slice(0,a)},basename:function(t,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');f(t);var n,a=0,o=-1,c=!0;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var g=i.length-1,m=-1;for(n=t.length-1;n>=0;--n){var P=t.charCodeAt(n);if(P===47){if(!c){a=n+1;break}}else m===-1&&(c=!1,m=n+1),g>=0&&(P===i.charCodeAt(g)?--g==-1&&(o=n):(g=-1,o=m))}return a===o?o=m:o===-1&&(o=t.length),t.slice(a,o)}for(n=t.length-1;n>=0;--n)if(t.charCodeAt(n)===47){if(!c){a=n+1;break}}else o===-1&&(c=!1,o=n+1);return o===-1?"":t.slice(a,o)},extname:function(t){f(t);for(var i=-1,n=0,a=-1,o=!0,c=0,g=t.length-1;g>=0;--g){var m=t.charCodeAt(g);if(m!==47)a===-1&&(o=!1,a=g+1),m===46?i===-1?i=g:c!==1&&(c=1):i!==-1&&(c=-1);else if(!o){n=g+1;break}}return i===-1||a===-1||c===0||c===1&&i===a-1&&i===n+1?"":t.slice(i,a)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return function(i,n){var a=n.dir||n.root,o=n.base||(n.name||"")+(n.ext||"");return a?a===n.root?a+o:a+"/"+o:o}(0,t)},parse:function(t){f(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var n,a=t.charCodeAt(0),o=a===47;o?(i.root="/",n=1):n=0;for(var c=-1,g=0,m=-1,P=!0,y=t.length-1,O=0;y>=n;--y)if((a=t.charCodeAt(y))!==47)m===-1&&(P=!1,m=y+1),a===46?c===-1?c=y:O!==1&&(O=1):c!==-1&&(O=-1);else if(!P){g=y+1;break}return c===-1||m===-1||O===0||O===1&&c===m-1&&c===g+1?m!==-1&&(i.base=i.name=g===0&&o?t.slice(1,m):t.slice(g,m)):(g===0&&o?(i.name=t.slice(1,c),i.base=t.slice(1,m)):(i.name=t.slice(g,c),i.base=t.slice(g,m)),i.ext=t.slice(c,m)),g>0?i.dir=t.slice(0,g-1):o&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};v.posix=v,h.exports=v}},p={};function b(h){var f=p[h];if(f!==void 0)return f.exports;var d=p[h]={exports:{}};return l[h](d,d.exports,b),d.exports}b.d=(h,f)=>{for(var d in f)b.o(f,d)&&!b.o(h,d)&&Object.defineProperty(h,d,{enumerable:!0,get:f[d]})},b.o=(h,f)=>Object.prototype.hasOwnProperty.call(h,f),b.r=h=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})};var w={};(()=>{var h;if(b.r(w),b.d(w,{URI:()=>m,Utils:()=>H}),typeof process=="object")h=process.platform==="win32";else if(typeof navigator=="object"){var f=navigator.userAgent;h=f.indexOf("Windows")>=0}var d,v,t=(d=function(s,e){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,u){r.__proto__=u}||function(r,u){for(var x in u)Object.prototype.hasOwnProperty.call(u,x)&&(r[x]=u[x])},d(s,e)},function(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=s}d(s,e),s.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}),i=/^\w[\w\d+.-]*$/,n=/^\//,a=/^\/\//,o="",c="/",g=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,m=function(){function s(e,r,u,x,C,A){A===void 0&&(A=!1),typeof e=="object"?(this.scheme=e.scheme||o,this.authority=e.authority||o,this.path=e.path||o,this.query=e.query||o,this.fragment=e.fragment||o):(this.scheme=function(S,k){return S||k?S:"file"}(e,A),this.authority=r||o,this.path=function(S,k){switch(S){case"https":case"http":case"file":k?k[0]!==c&&(k=c+k):k=c}return k}(this.scheme,u||o),this.query=x||o,this.fragment=C||o,function(S,k){if(!S.scheme&&k)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'.concat(S.authority,'", path: "').concat(S.path,'", query: "').concat(S.query,'", fragment: "').concat(S.fragment,'"}'));if(S.scheme&&!i.test(S.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(S.path){if(S.authority){if(!n.test(S.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(a.test(S.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}(this,A))}return s.isUri=function(e){return e instanceof s||!!e&&typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function"},Object.defineProperty(s.prototype,"fsPath",{get:function(){return K(this,!1)},enumerable:!1,configurable:!0}),s.prototype.with=function(e){if(!e)return this;var r=e.scheme,u=e.authority,x=e.path,C=e.query,A=e.fragment;return r===void 0?r=this.scheme:r===null&&(r=o),u===void 0?u=this.authority:u===null&&(u=o),x===void 0?x=this.path:x===null&&(x=o),C===void 0?C=this.query:C===null&&(C=o),A===void 0?A=this.fragment:A===null&&(A=o),r===this.scheme&&u===this.authority&&x===this.path&&C===this.query&&A===this.fragment?this:new y(r,u,x,C,A)},s.parse=function(e,r){r===void 0&&(r=!1);var u=g.exec(e);return u?new y(u[2]||o,Q(u[4]||o),Q(u[5]||o),Q(u[7]||o),Q(u[9]||o),r):new y(o,o,o,o,o)},s.file=function(e){var r=o;if(h&&(e=e.replace(/\\/g,c)),e[0]===c&&e[1]===c){var u=e.indexOf(c,2);u===-1?(r=e.substring(2),e=c):(r=e.substring(2,u),e=e.substring(u)||c)}return new y("file",r,e,o,o)},s.from=function(e){return new y(e.scheme,e.authority,e.path,e.query,e.fragment)},s.prototype.toString=function(e){return e===void 0&&(e=!1),J(this,e)},s.prototype.toJSON=function(){return this},s.revive=function(e){if(e){if(e instanceof s)return e;var r=new y(e);return r._formatted=e.external,r._fsPath=e._sep===P?e.fsPath:null,r}return e},s}(),P=h?1:void 0,y=function(s){function e(){var r=s!==null&&s.apply(this,arguments)||this;return r._formatted=null,r._fsPath=null,r}return t(e,s),Object.defineProperty(e.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=K(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),e.prototype.toString=function(r){return r===void 0&&(r=!1),r?J(this,!0):(this._formatted||(this._formatted=J(this,!1)),this._formatted)},e.prototype.toJSON=function(){var r={$mid:1};return this._fsPath&&(r.fsPath=this._fsPath,r._sep=P),this._formatted&&(r.external=this._formatted),this.path&&(r.path=this.path),this.scheme&&(r.scheme=this.scheme),this.authority&&(r.authority=this.authority),this.query&&(r.query=this.query),this.fragment&&(r.fragment=this.fragment),r},e}(m),O=((v={})[58]="%3A",v[47]="%2F",v[63]="%3F",v[35]="%23",v[91]="%5B",v[93]="%5D",v[64]="%40",v[33]="%21",v[36]="%24",v[38]="%26",v[39]="%27",v[40]="%28",v[41]="%29",v[42]="%2A",v[43]="%2B",v[44]="%2C",v[59]="%3B",v[61]="%3D",v[32]="%20",v);function I(s,e){for(var r=void 0,u=-1,x=0;x<s.length;x++){var C=s.charCodeAt(x);if(C>=97&&C<=122||C>=65&&C<=90||C>=48&&C<=57||C===45||C===46||C===95||C===126||e&&C===47)u!==-1&&(r+=encodeURIComponent(s.substring(u,x)),u=-1),r!==void 0&&(r+=s.charAt(x));else{r===void 0&&(r=s.substr(0,x));var A=O[C];A!==void 0?(u!==-1&&(r+=encodeURIComponent(s.substring(u,x)),u=-1),r+=A):u===-1&&(u=x)}}return u!==-1&&(r+=encodeURIComponent(s.substring(u))),r!==void 0?r:s}function L(s){for(var e=void 0,r=0;r<s.length;r++){var u=s.charCodeAt(r);u===35||u===63?(e===void 0&&(e=s.substr(0,r)),e+=O[u]):e!==void 0&&(e+=s[r])}return e!==void 0?e:s}function K(s,e){var r;return r=s.authority&&s.path.length>1&&s.scheme==="file"?"//".concat(s.authority).concat(s.path):s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?s.path.substr(1):s.path[1].toLowerCase()+s.path.substr(2):s.path,h&&(r=r.replace(/\//g,"\\")),r}function J(s,e){var r=e?L:I,u="",x=s.scheme,C=s.authority,A=s.path,S=s.query,k=s.fragment;if(x&&(u+=x,u+=":"),(C||x==="file")&&(u+=c,u+=c),C){var E=C.indexOf("@");if(E!==-1){var M=C.substr(0,E);C=C.substr(E+1),(E=M.indexOf(":"))===-1?u+=r(M,!1):(u+=r(M.substr(0,E),!1),u+=":",u+=r(M.substr(E+1),!1)),u+="@"}(E=(C=C.toLowerCase()).indexOf(":"))===-1?u+=r(C,!1):(u+=r(C.substr(0,E),!1),u+=C.substr(E))}if(A){if(A.length>=3&&A.charCodeAt(0)===47&&A.charCodeAt(2)===58)(j=A.charCodeAt(1))>=65&&j<=90&&(A="/".concat(String.fromCharCode(j+32),":").concat(A.substr(3)));else if(A.length>=2&&A.charCodeAt(1)===58){var j;(j=A.charCodeAt(0))>=65&&j<=90&&(A="".concat(String.fromCharCode(j+32),":").concat(A.substr(2)))}u+=r(A,!0)}return S&&(u+="?",u+=r(S,!1)),k&&(u+="#",u+=e?k:I(k,!1)),u}function G(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+G(s.substr(3)):s}}var X=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Q(s){return s.match(X)?s.replace(X,function(e){return G(e)}):s}var H,Y=b(470),ee=function(s,e,r){if(r||arguments.length===2)for(var u,x=0,C=e.length;x<C;x++)!u&&x in e||(u||(u=Array.prototype.slice.call(e,0,x)),u[x]=e[x]);return s.concat(u||Array.prototype.slice.call(e))},R=Y.posix||Y,z="/";(function(s){s.joinPath=function(e){for(var r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];return e.with({path:R.join.apply(R,ee([e.path],r,!1))})},s.resolvePath=function(e){for(var r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];var x=e.path,C=!1;x[0]!==z&&(x=z+x,C=!0);var A=R.resolve.apply(R,ee([x],r,!1));return C&&A[0]===z&&!e.authority&&(A=A.substring(1)),e.with({path:A})},s.dirname=function(e){if(e.path.length===0||e.path===z)return e;var r=R.dirname(e.path);return r.length===1&&r.charCodeAt(0)===46&&(r=""),e.with({path:r})},s.basename=function(e){return R.basename(e.path)},s.extname=function(e){return R.extname(e.path)}})(H||(H={}))})(),oe=w})();var{URI:ke,Utils:V}=oe;var q=U(require("util"));function ae(l){let p=new Set,b=new Set,w=new Set;ce(w),le(p,b);let h=new T.Emitter;return l.push(T.extensions.onDidActiveExtension(f=>{let d=new Set,v=new Set;le(d,v),(se(d,p)||se(v,b))&&(p=d,b=v,h.fire())})),l.push(T.workspace.onDidChangeConfiguration(f=>{f.affectsConfiguration("html.customData")&&(w.clear(),ce(w),h.fire())})),l.push(T.workspace.onDidChangeTextDocument(f=>{let d=f.textDocument.uri;(b.has(d)||w.has(d))&&h.fire()})),{get uris(){return[...p].concat([...b],[...w])},get onDidChange(){return h.event},getContent(f){let d=T.Uri.parse(f);return d.scheme==="file"?(0,q.promisify)(ie.default.readFile)(d.fsPath).then(v=>new q.TextDecoder().decode(v)):(0,T.fetch)(f,{timeout:5e3,buffer:!0}).then(v=>new q.TextDecoder().decode(v))}}}function se(l,p){if(l.size!==p.size)return!0;for(let b of l)if(!p.has(b))return!0;return!1}function ue(l){return/^(?<scheme>\w[\w\d+.-]*):/.test(l)}function ce(l){let p=T.workspace.workspaceFolders;if(!p)return;let b=(w,h)=>{if(Array.isArray(w))for(let f of w)typeof f=="string"&&(ue(f)?l.add(f):l.add(V.resolvePath(T.Uri.parse(h),f).toString()))};for(let w=0;w<p.length;w++){let h=p[w].uri,d=T.workspace.getConfiguration("html",h).inspect("customData");d&&(b(d.workspaceValue,h),w===0&&b(d.globalValue,h))}}function le(l,p){var b,w,h;for(let f of T.extensions.all){let d=(h=(w=(b=f.packageJSON)==null?void 0:b.contributes)==null?void 0:w.html)==null?void 0:h.customData;if(Array.isArray(d))for(let v of d)if(ue(v))p.add(v);else{let t=T.Uri.file(f.extensionPath);l.add(V.joinPath(t,v).toString())}}}var W;(p=>{p.type=new D.RequestType0("html/semanticTokenLegend")})(W||(W={}));var B;(p=>{p.type=new D.RequestType("html/semanticTokens")})(B||(B={}));var F;(p=>{p.type=new D.NotificationType("html/customDataChanged")})(F||(F={}));var Z;(p=>{p.type=new D.RequestType("html/customDataContent")})(Z||(Z={}));var $;(p=>{p.type=new D.RequestType("html/autoInsert")})($||($={}));function fe(l,p){let{subscriptions:b}=l,w=D.workspace.getConfiguration().get("html",{}),h=l.asAbsolutePath("lib/server.js"),f=p.map(a=>({language:a})),d={css:!0,javascript:!0},v={execArgv:["--nolazy","--inspect="+(8e3+Math.round(Math.random()*999))]},t={run:{module:h,transport:D.TransportKind.ipc,options:{execArgv:w.execArgv||[]}},debug:{module:h,transport:D.TransportKind.ipc,options:v}},i={documentSelector:f,synchronize:{configurationSection:["html","css","javascript"]},outputChannelName:"html",initializationOptions:{embeddedLanguages:d,handledSchemas:["file"]}},n=new D.LanguageClient("html","HTML language server",t,i);n.onReady().then(()=>{let a=ae(l.subscriptions);n.sendNotification(F.type,a.uris),a.onDidChange(()=>{n.sendNotification(F.type,a.uris)}),n.onRequest(Z.type,a.getContent);let o=(g,m,P)=>{let y={kind:g,textDocument:{uri:m.uri},position:P};return n.sendRequest($.type,y)},c=Object.assign({},...p.map(g=>({[g]:!0})));re(o,c,l.subscriptions),typeof D.languages.registerDocumentSemanticTokensProvider=="function"&&n.sendRequest(W.type).then(g=>{if(g){let m={provideDocumentSemanticTokens(y){let O={textDocument:{uri:y.uri}};return n.sendRequest(B.type,O).then(I=>I&&{data:I})},provideDocumentRangeSemanticTokens(y,O){let I={textDocument:{uri:y.uri},ranges:[O]};return n.sendRequest(B.type,I).then(L=>L&&{data:L})}},P={tokenTypes:g.types,tokenModifiers:g.modifiers};l.subscriptions.push(D.languages.registerDocumentSemanticTokensProvider(f,m,P)),l.subscriptions.push(D.languages.registerDocumentRangeSemanticTokensProvider(f,m,P))}})},a=>{}),b.push(D.services.registLanguageClient(n))}async function he(l){let p=D.workspace.getConfiguration("html");if(p.get("enable",!0)===!1)return;let w=p.get("filetypes",["html","handlebars","htmldjango","blade"]),h=!1;for(let f of D.workspace.textDocuments)w.includes(f.languageId)&&!h&&(h=!0,fe(l,w));if(!h){let f=D.workspace.onDidOpenTextDocument(d=>{h||!w.includes(d.languageId)||(f.dispose(),h=!0,fe(l,w))},null,l.subscriptions)}}module.exports=be(Ce);0&&(module.exports={activate});
//# sourceMappingURL=index.js.map
